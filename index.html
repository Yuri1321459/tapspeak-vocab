<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b1220" />
  <title>TapSpeak Vocab</title>
  <style>
    :root{
      --bg:#070b12;
      --panel:rgba(255,255,255,.06);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.62);
      --line:rgba(255,255,255,.10);
      --shadow: 0 10px 30px rgba(0,0,0,.45);
      --radius:18px;

      --blueA:#2b5cff;
      --blueB:#00c2ff;

      --greenA:#1bdc7a;
      --greenB:#00c2a8;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Hiragino Sans", "Hiragino Kaku Gothic ProN", "Noto Sans JP", Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 20% -10%, rgba(43,92,255,.18), transparent 60%),
        radial-gradient(900px 500px at 90% 0%, rgba(27,220,122,.12), transparent 55%),
        radial-gradient(1000px 700px at 50% 110%, rgba(0,194,255,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }

    /* Top bar */
    .topbar{
      position:sticky;
      top:0;
      z-index:10;
      padding: 14px 14px calc(14px + env(safe-area-inset-top));
      backdrop-filter: blur(14px);
      background: linear-gradient(to bottom, rgba(7,11,18,.92), rgba(7,11,18,.65));
      border-bottom:1px solid var(--line);
    }

    .topbar__row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      max-width: 980px;
      margin: 0 auto;
    }

    .brand{
      display:flex;
      flex-direction:column;
      line-height:1.15;
      gap:6px;
      min-width: 160px;
    }
    .brand__title{
      font-weight: 800;
      letter-spacing: .2px;
      font-size: 15px;
      opacity:.98;
    }
    .brand__sub{
      display:flex;
      align-items:center;
      gap:10px;
      font-size: 13px;
      color: var(--muted);
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      white-space:nowrap;
    }
    .pill strong{
      color: var(--text);
      font-weight:800;
      font-size: 15px;
    }

    .actions{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:8px;
      flex-wrap:wrap;
    }

    .btn{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 999px;
      padding: 10px 12px;
      font-weight: 700;
      font-size: 13px;
      letter-spacing:.1px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:active{ transform: translateY(1px); }
    .btn--icon{ padding:10px 12px; }
    .btn--primary{
      border: none;
      background: linear-gradient(135deg, rgba(43,92,255,.95), rgba(0,194,255,.85));
      box-shadow: 0 10px 25px rgba(43,92,255,.25);
    }
    .btn--green{
      border: none;
      background: linear-gradient(135deg, rgba(27,220,122,.95), rgba(0,194,168,.85));
      box-shadow: 0 10px 25px rgba(27,220,122,.18);
    }

    .modeTag{
      font-weight:900;
      border-radius: 999px;
      padding: 8px 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      font-size: 13px;
      white-space:nowrap;
    }
    .modeTag[data-mode="words"]{
      box-shadow: 0 0 0 1px rgba(43,92,255,.25) inset;
    }
    .modeTag[data-mode="review"]{
      box-shadow: 0 0 0 1px rgba(27,220,122,.22) inset;
    }

    /* Layout */
    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 16px 14px 40px;
    }

    .viewTitle{
      font-size: 18px;
      font-weight: 900;
      margin: 14px 4px 14px;
      letter-spacing:.2px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
    }
    @media (min-width: 820px){
      .grid{ grid-template-columns: 1fr 1fr; }
    }

    .card{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.075), rgba(255,255,255,.045));
      border:1px solid rgba(255,255,255,.10);
      box-shadow: var(--shadow);
      padding: 16px;
      position:relative;
      overflow:hidden;
    }

    .card__head{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:10px;
      margin-bottom: 12px;
    }

    .card__title{
      font-size: 16px;
      font-weight: 900;
      margin:0;
    }

    .miniInfo{
      font-size: 13px;
      color: var(--muted);
      font-weight: 800;
      display:inline-flex;
      align-items:center;
      gap:8px;
      white-space:nowrap;
    }
    .miniInfo__badge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      min-width: 46px;
      padding: 6px 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      font-weight: 900;
    }

    .card__actions{
      display:flex;
      gap:10px;
    }

    .card__actions .btn{
      width: 100%;
      justify-content:center;
      padding: 14px 14px;
      font-size: 14px;
      border-radius: 14px;
    }

    /* Settings smaller */
    .card--small{
      padding: 12px 14px;
      box-shadow: none;
      background: rgba(255,255,255,.04);
    }
    .card--small .card__actions .btn{
      padding: 12px 12px;
      font-size: 13px;
    }

    /* Hidden */
    .hidden{ display:none !important; }

    /* Simple screens */
    .screenNote{
      color: var(--muted);
      font-size: 13px;
      margin: 6px 4px 14px;
      line-height: 1.6;
    }

    .list{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .userItem{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding: 14px 14px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
    }
    .userItem:active{ transform: translateY(1px); }
    .userItem__name{
      font-weight: 900;
      font-size: 15px;
    }
    .userItem__sub{
      font-size: 12px;
      color: var(--muted);
      margin-top: 3px;
      font-weight: 700;
    }
    .devMark{
      font-size: 11px;
      color: rgba(255,255,255,.55);
      border: 1px dashed rgba(255,255,255,.18);
      padding: 4px 8px;
      border-radius: 999px;
      white-space:nowrap;
    }
  </style>
</head>

<body>
  <!-- Top bar (common) -->
  <header class="topbar" role="banner">
    <div class="topbar__row">
      <div class="brand">
        <div class="brand__title">TapSpeak Vocab</div>
        <div class="brand__sub">
          <span class="modeTag" id="modeTag" data-mode="words">ã„ã¾ã¯ï¼šãŸã‚“ã”</span>
          <span class="pill" aria-label="ãƒã‚¤ãƒ³ãƒˆ">
            â­ <strong id="pointsText">0</strong>
          </span>
        </div>
      </div>

      <div class="actions" role="navigation" aria-label="æ“ä½œ">
        <button class="btn btn--icon" id="btnHome" title="ãƒ›ãƒ¼ãƒ ">ğŸ </button>
        <button class="btn" id="btnCategory" title="ã‚«ãƒ†ã‚´ãƒªåˆ‡æ›¿">ğŸ”„ ã‚«ãƒ†ã‚´ãƒª</button>
        <button class="btn btn--primary" id="btnModeWords" title="å˜èªãƒ¢ãƒ¼ãƒ‰">ğŸ“˜ ãŸã‚“ã”</button>
        <button class="btn btn--green" id="btnModeReview" title="å¾©ç¿’ãƒ¢ãƒ¼ãƒ‰">ğŸŸ© ãµãã—ã‚…ã†</button>
        <button class="btn" id="btnUser" title="ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ‡æ›¿">ğŸ‘¤ åˆ‡æ›¿</button>
      </div>
    </div>
  </header>

  <main class="wrap" role="main">
    <!-- HOME -->
    <section id="viewHome">
      <div class="viewTitle">ãƒ›ãƒ¼ãƒ </div>

      <div class="grid">
        <!-- Words -->
        <div class="card">
          <div class="card__head">
            <h2 class="card__title">ãŸã‚“ã”</h2>
          </div>
          <div class="card__actions">
            <button class="btn btn--primary" id="goWords">ãŸã‚“ã”ã¸</button>
          </div>
        </div>

        <!-- Review with count: due <= today ONLY (no "æœŸé™åˆ‡ã‚Œ" wording) -->
        <div class="card">
          <div class="card__head">
            <h2 class="card__title">ãµãã—ã‚…ã†</h2>
            <div class="miniInfo" id="dueInfo">
              <span>ã„ã¾ ã‚„ã‚‹ ã“ã¨ã°</span>
              <span class="miniInfo__badge"><span id="dueCountText">0</span>ã“</span>
            </div>
          </div>
          <div class="card__actions">
            <button class="btn btn--green" id="goReview">ãµãã—ã‚…ã†ã¸</button>
          </div>
        </div>

        <!-- Settings (smaller) -->
        <div class="card card--small">
          <div class="card__head">
            <h2 class="card__title">ã›ã£ã¦ã„</h2>
          </div>
          <div class="card__actions">
            <button class="btn" id="goSettings">ã›ã£ã¦ã„ã¸</button>
          </div>
        </div>
      </div>
    </section>

    <!-- USER SELECT -->
    <section id="viewUser" class="hidden">
      <div class="viewTitle">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãˆã‚‰ã³</div>
      <div class="screenNote">
        ã¤ã‹ã† ã²ã¨ã‚’ ãˆã‚‰ã‚“ã§ã­ã€‚
      </div>

      <div class="list" id="userList">
        <!-- JS renders -->
      </div>
    </section>

    <!-- WORDS (placeholder for next file) -->
    <section id="viewWords" class="hidden">
      <div class="viewTitle">ãŸã‚“ã”</div>
      <div class="screenNote">
        â€» ã“ã®å…ˆï¼ˆå˜èªã‚«ãƒ¼ãƒ‰ã®ä¸€è¦§ï¼ç”»åƒâ‡„å˜èªã®åˆ‡æ›¿ï¼ãŠã¼ãˆãŸãƒ»ã‚ã™ã‚ŒãŸï¼ãƒ•ã‚£ãƒ«ã‚¿ï¼‰ã¯ã€æ¬¡ã®å®Ÿè£…ã§ä½œã‚Šã¾ã™ã€‚
      </div>
      <div class="card">
        <div class="card__head">
          <h2 class="card__title">ã˜ã‚…ã‚“ã³ã¡ã‚…ã†</h2>
        </div>
        <div class="screenNote" id="wordsStatus">ãƒ‡ãƒ¼ã‚¿ã‚’ ã‚ˆã¿ã“ã¿ã¾ã™â€¦</div>
      </div>
    </section>

    <!-- REVIEW (placeholder for next file) -->
    <section id="viewReview" class="hidden">
      <div class="viewTitle">ãµãã—ã‚…ã†</div>
      <div class="screenNote">
        â€» ã“ã®å…ˆï¼ˆğŸ¤â†’ğŸ”Šâ†’â—¯/Ã—ï¼å½“æ—¥ãƒ«ãƒ¼ãƒ—ï¼stage0ã€œ6ï¼åŠ¹æœéŸ³ãƒ»æ¼”å‡ºï¼ä¸€è¦§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰ã¯ã€æ¬¡ã®å®Ÿè£…ã§ä½œã‚Šã¾ã™ã€‚
      </div>
      <div class="card">
        <div class="card__head">
          <h2 class="card__title">ã˜ã‚…ã‚“ã³ã¡ã‚…ã†</h2>
          <div class="miniInfo">
            <span>ã„ã¾ ã‚„ã‚‹ ã“ã¨ã°</span>
            <span class="miniInfo__badge"><span id="dueCountText2">0</span>ã“</span>
          </div>
        </div>
        <div class="screenNote" id="reviewStatus">ã˜ã‚…ã‚“ã³ã¡ã‚…ã†â€¦</div>
      </div>
    </section>

    <!-- SETTINGS (placeholder) -->
    <section id="viewSettings" class="hidden">
      <div class="viewTitle">ã›ã£ã¦ã„</div>
      <div class="screenNote">
        â€» ãƒªã‚»ãƒƒãƒˆï¼ˆPINã‚ã‚Šï¼‰ãªã©ã¯ã€æ¬¡ã®å®Ÿè£…ã§ä½œã‚Šã¾ã™ã€‚
      </div>
      <div class="card">
        <div class="card__head">
          <h2 class="card__title">ã˜ã‚…ã‚“ã³ã¡ã‚…ã†</h2>
        </div>
        <div class="screenNote">ã“ã® ãŒã‚ã‚“ã¯ ã¤ãã§ ã¤ãã‚Šã¾ã™ã€‚</div>
      </div>
    </section>
  </main>

  <script>
    // ===== Minimal app shell (navigation + top bar + user select + count placeholders) =====
    // æ³¨æ„ï¼šstageæ•°ã®è¡¨ç¤ºã¯è¡Œã‚ãªã„ï¼ˆå†…éƒ¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰ã€‚
    // æ³¨æ„ï¼šã€ŒæœŸé™åˆ‡ã‚Œã€ã¨ã„ã†æ–‡è¨€ã¯ä½¿ç”¨ã—ãªã„ã€‚
    // æ³¨æ„ï¼šå¾©ç¿’ã¯ã€Œã„ã¾ ã‚„ã‚‹ ã“ã¨ã°ï¼ˆdue <= todayï¼‰ã®ã¿ã€å‡ºã™å‰æã€‚

    const STORAGE_KEY = "tapspeak_state_v1";

    function loadState(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return {
          userId: "riona",
          points: 0
        };
        const st = JSON.parse(raw);
        if(typeof st !== "object" || !st) throw new Error("bad state");
        return {
          userId: st.userId ?? "riona",
          points: Number.isFinite(st.points) ? st.points : 0
        };
      }catch(e){
        return { userId:"riona", points:0 };
      }
    }

    function saveState(next){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(next));
    }

    const USERS = [
      { id:"riona", name:"ã‚ŠãŠãª", sub:"5ã•ã„", dev:false },
      { id:"soma", name:"ãã†ã¾", sub:"ï¼ˆã“ã‚Œã‹ã‚‰ï¼‰", dev:false },
      // è¦æœ›ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼é¸æŠç”»é¢ã«ã€Œé–‹ç™ºè€…ã€ã‚’å°ã•ãè¡¨ç¤º
      { id:"dev", name:"ã‹ã„ã¯ã¤", sub:"ãƒ†ã‚¹ãƒˆã‚ˆã†", dev:true }
    ];

    const state = loadState();

    // Views
    const viewHome = document.getElementById("viewHome");
    const viewUser = document.getElementById("viewUser");
    const viewWords = document.getElementById("viewWords");
    const viewReview = document.getElementById("viewReview");
    const viewSettings = document.getElementById("viewSettings");

    const pointsText = document.getElementById("pointsText");
    const modeTag = document.getElementById("modeTag");
    const dueCountText = document.getElementById("dueCountText");
    const dueCountText2 = document.getElementById("dueCountText2");

    function setModeTag(mode){
      if(mode === "review"){
        modeTag.dataset.mode = "review";
        modeTag.textContent = "ã„ã¾ã¯ï¼šãµãã—ã‚…ã†";
      }else{
        modeTag.dataset.mode = "words";
        modeTag.textContent = "ã„ã¾ã¯ï¼šãŸã‚“ã”";
      }
    }

    function setPoints(v){
      pointsText.textContent = String(v ?? 0);
    }

    // ç¾æ™‚ç‚¹ã¯0å›ºå®šï¼ˆå¾©ç¿’ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…å¾Œã«ã€Œã„ã¾ ã‚„ã‚‹ ã“ã¨ã°ã€ã®æ•°ã‚’å…¥ã‚Œã‚‹ï¼‰
    function setDueCount(v){
      dueCountText.textContent = String(v ?? 0);
      dueCountText2.textContent = String(v ?? 0);
    }

    function showOnly(view){
      [viewHome, viewUser, viewWords, viewReview, viewSettings].forEach(v => v.classList.add("hidden"));
      view.classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: "instant" });
    }

    // Render users
    function renderUsers(){
      const list = document.getElementById("userList");
      list.innerHTML = "";
      for(const u of USERS){
        const row = document.createElement("div");
        row.className = "userItem";
        row.setAttribute("role","button");
        row.tabIndex = 0;

        const left = document.createElement("div");
        const nm = document.createElement("div");
        nm.className = "userItem__name";
        nm.textContent = u.name;
        const sb = document.createElement("div");
        sb.className = "userItem__sub";
        sb.textContent = u.sub;
        left.appendChild(nm);
        left.appendChild(sb);

        const right = document.createElement("div");
        if(u.dev){
          const mark = document.createElement("span");
          mark.className = "devMark";
          mark.textContent = "é–‹ç™ºè€…";
          right.appendChild(mark);
        }else{
          // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆåˆã‚ã›ã®ãƒ€ãƒŸãƒ¼ï¼ˆè¡¨ç¤ºã¯ã—ãªã„ï¼‰
          const mark = document.createElement("span");
          mark.className = "devMark";
          mark.style.borderStyle = "solid";
          mark.style.opacity = ".0";
          mark.textContent = " ";
          right.appendChild(mark);
        }

        row.appendChild(left);
        row.appendChild(right);

        function pick(){
          state.userId = u.id;
          saveState(state);
          showOnly(viewHome);
        }
        row.addEventListener("click", pick);
        row.addEventListener("keydown", (e) => {
          if(e.key === "Enter" || e.key === " "){ e.preventDefault(); pick(); }
        });

        list.appendChild(row);
      }
    }

    // Buttons
    document.getElementById("btnHome").addEventListener("click", () => showOnly(viewHome));
    document.getElementById("btnUser").addEventListener("click", () => { renderUsers(); showOnly(viewUser); });

    document.getElementById("goWords").addEventListener("click", () => { setModeTag("words"); showOnly(viewWords); });
    document.getElementById("goReview").addEventListener("click", () => { setModeTag("review"); showOnly(viewReview); });
    document.getElementById("goSettings").addEventListener("click", () => showOnly(viewSettings));

    document.getElementById("btnModeWords").addEventListener("click", () => { setModeTag("words"); showOnly(viewWords); });
    document.getElementById("btnModeReview").addEventListener("click", () => { setModeTag("review"); showOnly(viewReview); });

    document.getElementById("btnCategory").addEventListener("click", () => {
      // ã‚«ãƒ†ã‚´ãƒªåˆ‡æ›¿UIã¯æ¬¡ã®å®Ÿè£…ã§è¿½åŠ ï¼ˆã“ã“ã§ã¯é–‹ç™ºå‘ã‘ã®æ¡ˆå†…ã®ã¿ï¼‰
      alert("ã‚«ãƒ†ã‚´ãƒªãã‚Šã‹ãˆã¯ã€ã¤ãã®ã˜ã£ãã†ã§ ã¤ãã‚Šã¾ã™ã€‚");
    });

    // Init
    setPoints(state.points);
    setDueCount(0);
    setModeTag("words");

    // Lightweight data load ping (optional; dev-only)
    (async () => {
      const wordsStatus = document.getElementById("wordsStatus");
      const reviewStatus = document.getElementById("reviewStatus");
      try{
        const res = await fetch("data/words.json", { cache: "no-store" });
        if(!res.ok) throw new Error("words.json not found");
        const data = await res.json();
        const n = Array.isArray(data) ? data.length : (Array.isArray(data?.words) ? data.words.length : null);
        wordsStatus.textContent = (n == null) ? "ãƒ‡ãƒ¼ã‚¿ã® ã‹ãŸã¡ã‚’ ã‹ãã«ã‚“ã¡ã‚…ã†â€¦" : `ã“ã¨ã°ï¼š${n}ã“`;
        reviewStatus.textContent = "ã˜ã‚…ã‚“ã³ã¡ã‚…ã†â€¦";
      }catch(e){
        wordsStatus.textContent = "data/words.json ãŒ ãªãã¦ã‚‚ OKï¼ˆã¤ãã§ ã¨ã¨ã®ãˆã¾ã™ï¼‰";
        reviewStatus.textContent = "ã˜ã‚…ã‚“ã³ã¡ã‚…ã†â€¦";
      }
    })();
  </script>
</body>
</html>
